<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

    <!--
        不建议修改下面的配置！！！！
        不建议修改下面的配置！！！！
        不建议修改下面的配置！！！！
        如果需要更改配置，请直接更改 config.properties 文件
        如果需要加载别的位置的 config.properties 文件，
        请修改 <context:property-placeholder location="properties/config.properties"/>

                                                           来自作者 水不要鱼 的温馨提示 :)
    -->

    <!-- 配置文件加载 -->
    <!-- 如果需要加载别的配置文件，就在这里设置 -->
    <context:property-placeholder location="properties/config.properties"/>

    <!-- 扫描包 -->
    <context:component-scan base-package="vip.ifmm"/>

    <!-- App 应用启动入口 -->
    <bean id="app" class="vip.ifmm.core.App">
        <property name="channelHandler" ref="nioServer"/>
        <property name="nioServerPort" value="${nioServerPort}"/>
        <property name="closeNioServerPort" value="${closeNioServerPort}"/>
    </bean>

    <!-- Nio 服务器 -->
    <bean id="nioServer" class="${nioServerInitializer}">
        <property name="channelHandler">
            <bean class="${nioServerHandler}">
                <property name="protocolParser" ref="protocolParser"/>
            </bean>
        </property>
    </bean>

    <!-- 协议解析器 -->
    <bean id="protocolParser" class="${protocolParser}"/>

    <!-- 配置节点数据事件处理器 -->
    <bean id="nodeDataEventHandler" class="${nodeDataEventHandler}">
        <property name="mappingHandler" ref="mappingHandler"/>
        <property name="nodeSelector">
            <bean class="${nodeSelector}"/>
        </property>
        <property name="resultHandler">
            <bean class="${resultHandler}"/>
        </property>
    </bean>

    <!-- 配置节点管理器 -->
    <bean id="nodeManager" class="${nodeManager}" init-method="init">
        <property name="numberOfNodes" value="${numberOfNodes}"/>
        <property name="nodeClassName" value="${nodeClassName}"/>
        <property name="handler" ref="nodeDataEventHandler"/>
    </bean>

    <!-- 映射器工具类 -->
    <bean id="mappingHandler" class="${mappingHandler}" init-method="init">
        <property name="nodeManager" ref="nodeManager"/>
    </bean>
</beans>